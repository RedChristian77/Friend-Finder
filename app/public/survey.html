<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.5/css/bulma.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.5/css/bulma.css.map">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.5/css/bulma.min.css">
    <title>Survey</title>
</head>

<body>
    <h1> Survey Page</h1>
    <!--Insert Name Here-->
    <div>
    <input class="input" type="text" placeholder="Your Name Here" id="personName">
    <br>
    </div>
    <div>
    <input class="input" type="text" placeholder="Link to your image" id="imageLink">
    </div>
    <!-- First Question-->
    <div class="container">
        <h3>You would Rather be inside and watch TV then go Hiking?</h3>
        <div class="control">
            <label class="radio">
                <input type="radio" name="question1" value="1">
                Compltely disagree
            </label>
            <label class="radio">
                <input type="radio" name="question1" value="2">
                Somewhat disagree
            </label>
            <label class="radio">
                <input type="radio" name="question1" value="3">
                No opinion
            </label>
            <label class="radio">
                <input type="radio" name="question1" value="4">
                Somewhat Agree
            </label>
            <label class="radio">
                <input type="radio" name="question1" value="5">
                Completely Agree
            </label>
        </div>
    </div>
    <br>
    <!-- Second Question-->
    <div class="container">
        <h3>I put my toilet paper over instead of Under</h3>
        <div class="control">
            <label class="radio">
                <input type="radio" name="question2" value="1">
                Compltely disagree
            </label>
            <label class="radio">
                <input type="radio" name="question2" value="2">
                Somewhat disagree
            </label>
            <label class="radio">
                <input type="radio" name="question2" value="3">
                No opinion
            </label>
            <label class="radio">
                <input type="radio" name="question2" value="4">
                Somewhat Agree
            </label>
            <label class="radio">
                <input type="radio" name="question2" value="5">
                Completely Agree
            </label>
        </div>
    </div>
    <br>
    <!-- Third Question -->
    <div class="container">
        <h3>I am a spontaneous person</h3>
        <div class="control">
            <label class="radio">
                <input type="radio" name="question3" value="1">
                Compltely disagree
            </label>
            <label class="radio">
                <input type="radio" name="question3" value="2">
                Somewhat disagree
            </label>
            <label class="radio">
                <input type="radio" name="question3" value="3">
                No opinion
            </label>
            <label class="radio">
                <input type="radio" name="question3" value="4">
                Somewhat Agree
            </label>
            <label class="radio">
                <input type="radio" name="question3" value="5">
                Completely Agree
            </label>
        </div>
    </div>
    <br>
    <!--Fourth Question-->
    <div class="container">
        <h3>I enjoy playing Video Games</h3>
        <div class="control">
            <label class="radio">
                <input type="radio" name="question4" value="1">
                Compltely disagree
            </label>
            <label class="radio">
                <input type="radio" name="question4" value="2">
                Somewhat disagree
            </label>
            <label class="radio">
                <input type="radio" name="question4" value="3">
                No opinion
            </label>
            <label class="radio">
                <input type="radio" name="question4" value="4">
                Somewhat Agree
            </label>
            <label class="radio">
                <input type="radio" name="question4" value="5">
                Completely Agree
            </label>
        </div>
    </div>
    <br>
    <!-- Fifth Question-->
    <div class="container">
        <h3>I am Introverted</h3>
        <div class="control">
            <label class="radio">
                <input type="radio" name="question5" value="1">
                Compltely disagree
            </label>
            <label class="radio">
                <input type="radio" name="question5" value="2">
                Somewhat disagree
            </label>
            <label class="radio">
                <input type="radio" name="question5" value="3">
                No opinion
            </label>
            <label class="radio">
                <input type="radio" name="question5" value="4">
                Somewhat Agree
            </label>
            <label class="radio">
                <input type="radio" name="question5" value="5">
                Completely Agree
            </label>
        </div>
    </div>
    <br>
    <!-- Sixth Question-->
    <div class="container">
        <h3>I Like to Travel</h3>
        <div class="control">
            <label class="radio">
                <input type="radio" name="question6" value="1">
                Compltely disagree
            </label>
            <label class="radio">
                <input type="radio" name="question6" value="2">
                Somewhat disagree
            </label>
            <label class="radio">
                <input type="radio" name="question6" value="3">
                No opinion
            </label>
            <label class="radio">
                <input type="radio" name="question6" value="4">
                Somewhat Agree
            </label>
            <label class="radio">
                <input type="radio" name="question6" value="5">
                Completely Agree
            </label>
        </div>
    </div>
    <br>
    <!-- Seventh Question-->
    <div class="container">
        <h3>I prefer sweet over Salty</h3>
        <div class="control">
            <label class="radio">
                <input type="radio" name="question7" value="1">
                Compltely disagree
            </label>
            <label class="radio">
                <input type="radio" name="question7" value="2">
                Somewhat disagree
            </label>
            <label class="radio">
                <input type="radio" name="question7" value="3">
                No opinion
            </label>
            <label class="radio">
                <input type="radio" name="question7" value="4">
                Somewhat Agree
            </label>
            <label class="radio">
                <input type="radio" name="question7" value="5">
                Completely Agree
            </label>
        </div>
    </div>
    <br>
    <!-- Eigth Question-->
    <div class="container">
        <h3>I Like Dogs</h3>
        <div class="control">
            <label class="radio">
                <input type="radio" name="question8" value="1">
                Compltely disagree
            </label>
            <label class="radio">
                <input type="radio" name="question8" value="2">
                Somewhat disagree
            </label>
            <label class="radio">
                <input type="radio" name="question8" value="3">
                No opinion
            </label>
            <label class="radio">
                <input type="radio" name="question8" value="4">
                Somewhat Agree
            </label>
            <label class="radio">
                <input type="radio" name="question8" value="5">
                Completely Agree
            </label>
        </div>
    </div>
    <br>
    <!-- Ninth Question-->
    <div class="container">
        <h3>I prefer Marvel over DC</h3>
        <div class="control">
            <label class="radio">
                <input type="radio" name="question9" value="1">
                Compltely disagree
            </label>
            <label class="radio">
                <input type="radio" name="question9" value="2">
                Somewhat disagree
            </label>
            <label class="radio">
                <input type="radio" name="question9" value="3">
                No opinion
            </label>
            <label class="radio">
                <input type="radio" name="question9" value="4">
                Somewhat Agree
            </label>
            <label class="radio">
                <input type="radio" name="question9" value="5">
                Completely Agree
            </label>
        </div>
    </div>
    <br>
    <!-- Tenth and Final Question-->
    <div class="container">
        <h3>I like Pineapple on my Pizza</h3>
        <div class="control">
            <label class="radio">
                <input type="radio" name="question10" value="1">
                Compltely disagreea
            </label>
            <label class="radio">
                <input type="radio" name="question10" value="2">
                Somewhat disagree
            </label>
            <label class="radio">
                <input type="radio" name="question10" value="3">
                No opinion
            </label>
            <label class="radio">
                <input type="radio" name="question10" value="4">
                Somewhat Agree
            </label>
            <label class="radio">
                <input type="radio" name="question10" value="5">
                Completely Agree
            </label>
        </div>
    </div>
    <br>
    <div class="container">
        <button class="button is-success is large" id="submit-btn">Submit Your Info</a>
    </div>
    <div class="modal is-hidden-tablet is-hidden-mobile" id="isModal">
        <div class="modal-background has-background-primary"></div>
        <div class="modal-content">
            <div class="container has-text-white has-background-black">
                <h1>Your closest Match of <span class="closeness"> </span></h1>
            </div>
            <div class="container has-text-white has-background-black">
                <h3>Name: <span class="matchname"></span> </h3><br>
                <img src="" alt="" id="imgSrc"><br>

            </div>
        </div>
        <button class="modal-close is-large" aria-label="close" id="modalclose-btn"></button>
    </div>
</body>
<script>
    //script for pushing the items into an array
    document.getElementById("submit-btn").addEventListener("click",function(event) {
        event.preventDefault();
        let info = {
            name: document.getElementById("personName").value,
            photo: document.getElementById("imageLink").value,
            scores: []
        }
        
        if(info.name === "" || info.photo === ""){
            alert("You must fill in all the information");
            return;
        }
        for(i=1;i<11;i++){
            let test = 0;
            let questSearch = "question"+i;
            let radioBtn = document.getElementsByName(questSearch);
            for(k=0;k<radioBtn.length;k++){
                if(radioBtn[k].checked){
                    info.scores.push(radioBtn[k].value)
                    test++;
                }
            }
            if(test < 1){
                alert("You didnt fill in Question #"+i);
                return;
            }  
        }
        
        //script for post
        fetch("/api/friends", {
            method:"POST",
            body: JSON.stringify(info),
            headers: { "Content-Type": "application/json" },
        })
        .then((res) => res.json())
        .then(function(data) {
            console.log(data);
            let leadname = "";
            let photourl = "";
            let leadDif = 100;
            for(i=0; i<data.length-1;i++){
                let difference = 0;
                for(k=0; k<data[i].scores.length; k++){
                    difference += (Math.abs(data[i].scores[k] - info.scores[k]));
                }
                if(difference < leadDif){
                    leadname = data[i].name;
                    photourl = data[i].photo;
                    leadDif = difference;
                }
            }
            //editing the modal
            document.getElementsByClassName("closeness")[0].innerHTML= leadDif;
            document.getElementsByClassName("matchname")[0].innerHTML = leadname;
            document.getElementById("imgSrc").setAttribute("href",photourl);
            document.getElementById("isModal").classList.remove("is-hidden-tablet");
            document.getElementById("isModal").classList.remove("is-hidden-mobile");
            document.getElementById("isModal").classList.add("is-active");
        })
    })

    document.getElementById("modalclose-btn").addEventListener("click", function(event) {
        document.getElementById("isModal").classList.remove("is-active");
    })
</script>
</html>